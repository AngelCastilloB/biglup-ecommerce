<biglup-modal-message (onClose)="_onModalClosed($event)"></biglup-modal-message>
<div class="add-product-content">
  <h4 class="biglup-add-product-title">{{ 'Add Product' | translate }}</h4>
  <biglup-breadcrumb>
    <a [routerLink]="['/admin/dashboard']"><i class="material-icons md-16">home</i>{{ 'Dashboard' | translate }}</a>
    <a [routerLink]="['/admin/products']"><i class="material-icons md-16">card_travel</i>{{ 'Products' | translate }}</a>
    <a *ngIf="!_isEditMode" class="active"><i class="material-icons md-16">add_circle_outline</i> {{ 'Add Product' | translate }}</a>
    <a *ngIf="_isEditMode" class="active"><i class="material-icons md-16">mode_edit</i> {{ 'Edit Product' | translate }}</a>
  </biglup-breadcrumb>

  <div *ngIf="_product.title[0]">
    <biglup-tabs>
      <biglup-tab *ngFor="let lang of _i18nService.getSupportedLanguages()" [title]="_i18nService.getOriginalName(lang)">
        <br>
        <i18n-input [isRequiered]="true" [(model)]="_i18nTitleReferenceMap[lang]" placeholder="{{ 'Title' | translate }}" [language]="_i18nService.getOriginalName(lang)"></i18n-input>
        <br>
        <br>
        <span><b>{{ 'Description' | translate }}</b></span>
        <i18n-text-editor [(model)]="_i18nDescReferenceMap[lang]"></i18n-text-editor>
      </biglup-tab>
    </biglup-tabs>

    <biglup-paper elevation="1">
      <product-image-manager #imagesManager [(model)]="_product.images"></product-image-manager>
    </biglup-paper>

    <biglup-paper elevation="1">
      <span><b>{{ 'Pricing' | translate }}</b></span><br>
      <div class="biglup-grid">
        <div class="biglup-cell biglup-cell-6-col">
          <biglup-input hint="{{'Price' | translate}}" floatingHint="true" [(value)]="_product.price" [filter]="InputFilters.numerical"></biglup-input>
        </div>
        <div class="biglup-cell biglup-cell-6-col">
          <biglup-input hint="{{'Discount' | translate}}" floatingHint="true" [(value)]="_product.discount" [filter]="InputFilters.numerical"></biglup-input>
        </div>
      </div>
    </biglup-paper>
    <br>
    <biglup-paper elevation="1">
      <span><b>{{ 'Categories' | translate }}</b></span></br>
      <div class="biglup-grid">
        <div class="biglup-cell biglup-cell-3-col" *ngFor="let category of _categoriesService.getCategories() | async">
          <biglup-checkbox [checked]="_productHasCategory(category._id)"
                           (checkedChange)="_onCategoryToggle(category._id, $event)">
            {{category.name | mongoTranslate}}
          </biglup-checkbox>
        </div>
      </div>

    </biglup-paper>

    <biglup-paper elevation="1">
      <span><b>{{ 'Inventory' | translate }}</b></span><br>
      <div class="biglup-grid">
        <div class="biglup-cell biglup-cell-6-col">
          <biglup-input #skuInput hint="{{'SKU (Stock Keeping Unit)' | translate}}" floatingHint="true" [(value)]="_product.sku"></biglup-input>
        </div>
        <div class="biglup-cell biglup-cell-6-col">
          <biglup-input #barcodeInput hint="{{'Barcode (ISBN, UPC, GTIN, etc.)' | translate}}" floatingHint="true" [(value)]="_product.barcode"></biglup-input>
        </div>
      </div>
      <br>
      <br>
      <span><b>{{ 'Inventory Policy' | translate }}</b></span>
      <br>
      <br>
      <div class="biglup-grid">
        <div class="biglup-cell biglup-cell-6-col">
          <biglup-checkbox [(checked)]="_product.trackInventory">
            {{ 'Track Inventory' | translate }}
          </biglup-checkbox>
        </div>
        <div class="biglup-cell biglup-cell-6-col" *ngIf="_product.trackInventory" >
          <biglup-input hint="{{ 'Quantity' | translate }}" [(value)]="_product.stock" id="quantity" name="quantity" floatingHint="true"></biglup-input>
        </div>
        <div class="biglup-cell biglup-cell-12-col" *ngIf="_product.trackInventory" >
          <biglup-checkbox [(checked)]="_product.isBackorder" name="allow-backorder" id="allow-backorder">
            {{ "Allow customers to purchase this product when it's out of stock" | translate }}
          </biglup-checkbox>
        </div>
        <div class="biglup-cell biglup-cell-12-col">
          <biglup-checkbox [(checked)]="_product.requiresShipping">
            {{ "This product requires shipping" | translate }}
          </biglup-checkbox>
        </div>
      </div>
    </biglup-paper>

    <biglup-paper elevation="1">
      <span><b>{{ 'Visibility' | translate }}</b></span><br><br>
      <biglup-checkbox [(checked)]="_product.isVisible">
        {{ "Show this product in the store" | translate }}
      </biglup-checkbox>
    </biglup-paper>
  </div>
  <br>
  <biglup-button class="add-product-left-buttons add-product-buttons"
                 raised="true"
                 *ngIf="_isEditMode"
                 (click)="_deleteProduct()"
                 color="warn">{{'Delete' | translate }}
  </biglup-button>

  <biglup-button class="add-product-right-buttons add-product-buttons"
                 raised="true"
                 *ngIf="!_isEditMode"
                 (click)="_saveProduct()"
                 color="primary">{{'Create' | translate }}
  </biglup-button>

  <biglup-button class="add-product-right-buttons add-product-buttons"
                 raised="true"
                 *ngIf="_isEditMode"
                 (click)="_updateProduct()"
                 color="primary">{{'Update' | translate }}
  </biglup-button>

  <biglup-button class="add-product-right-buttons add-product-buttons-cancel"
                 raised="true"
                 (click)="_onCancel()">{{'Cancel' | translate }}
  </biglup-button>

</div>